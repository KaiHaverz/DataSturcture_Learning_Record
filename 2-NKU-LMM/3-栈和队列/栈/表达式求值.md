# 实验报告1_表达式求值

## 1 实验信息
- 软件学院 2022 级 4 班
- 2213189 李懋
- 题目: 表达式求值
  
  

## 2 算法思路

整个程序大致可以分为四个部分:栈的实现,中缀表达式转后缀表达式,计算后缀表达式,主函数

1. **栈的实现**：
   - 使用模板类 `stack` 实现一个泛型栈，支持基本的栈操作（压栈、弹栈、获取栈顶元素等）。
2. **中缀表达式转后缀表达式**：
   - 定义一个函数 `change`，将输入的中缀表达式转换为后缀表达式。
   - 使用两个栈：一个用于存储操作符（`t`），另一个用于存储后缀表达式（`s2`）。
   - 遍历中缀表达式的每个字符，根据字符类型（数字、操作符、括号）进行相应的处理。
3. **计算后缀表达式**：
   - 定义一个函数 `count`，计算后缀表达式的值。
   - 使用一个栈 `num` 存储操作数，遍历后缀表达式的每个字符，根据字符类型（数字、操作符）进行相应的计算。
4. **主函数**：
   - 定义一个主函数 ，处理输入的字符串，调用 `change` 和 `count` 函数进行计算，并输出结果或错误信息。



## 3 测试用例

| 测试用例                                    | 测试目的                                 | 预期输出                  | 实际输出                  |
| :------------------------------------------ | :--------------------------------------- | :------------------------ | :------------------------ |
| `3 + 5 * (2 - 8)`                           | 测试基本的四则运算和括号优先级           | `-22.00`                  | `-22.00`                  |
| `3 + 5 * (2 - 8) / 2`                       | 测试四则运算和括号优先级，以及除法操作   | `-12.00`                  | `-12.00`                  |
| `3 + 5 * (2 - 8) / 2 + 4`                   | 测试多个操作符的混合运算                 | `-8.00`                   | `-8.00`                   |
| `3 + 5 * (2 - 8) / 2 + 4 * (3 - 1)`         | 测试多个括号嵌套和混合运算               | `0.00`                    | `0.00`                    |
| `3 + 5 * (2 - 8) / 2 + 4 * (3 - 1) / 2`     | 测试多个括号嵌套和混合运算，以及除法操作 | `2.00`                    | `2.00`                    |
| `3.5 + 2.1 * (4.2 - 1.8)`                   | 测试浮点数的运算                         | `8.54`                    | `8.54`                    |
| `3 + 5 % 2`                                 | 测试取模运算                             | `4.00`                    | `4.00`                    |
| `2 ^ 3`                                     | 测试幂运算                               | `8.00`                    | `8.00`                    |
| `(3 + 5) * (2 - 8)`                         | 测试括号的优先级                         | `-48.00`                  | `-48.00`                  |
| `3 + 5 * (2 - 8) / 0`                       | 测试除零错误处理                         | `ERROR IN INFIX NOTATION` | `ERROR IN INFIX NOTATION` |
| `3 + 5 * (2 - 8) / (4 - 4)`                 | 测试除零错误处理                         | `ERROR IN INFIX NOTATION` | `ERROR IN INFIX NOTATION` |
| `3 + 5 * (2 - 8) / 2 + 4 * (3 - 1) / 0`     | 测试除零错误处理                         | `ERROR IN INFIX NOTATION` | `ERROR IN INFIX NOTATION` |
| `3 + 5 * (2 - 8) / 2 + 4 * (3 - 1) / 2 +`   | 测试非法操作符处理                       | `ERROR IN INFIX NOTATION` | `ERROR IN INFIX NOTATION` |
| `3 + 5 * (2 - 8) / 2 + 4 * (3 - 1) / 2 + a` | 测试非法字符处理                         | `ERROR IN INFIX NOTATION` | `ERROR IN INFIX NOTATION` |





### 3.1 测试结果分析

1. 本次测试结果涵盖了包含 `+`、`-`、`*`、`/`、`%`、`^`、`(`、`)` 在内的全部运算符的使用。从简单的测试数据（如表达式 `3 + 5 * (2 - 8)`）到较为复杂的表达式（如表达式 `3 + 5 * (2 - 8) / 2 + 4 * (3 - 1) / 2`）都有相应的数据测试。对于小数，基本测试了较为简单的计算（如 `3.5 + 2.1 * (4.2 - 1.8)`），但没有考虑对小数取模的检测，但基本的运算测试均有包含，并从测试结果中可以看到结果正确。

2. 对于表达式中出现的非法字符，从测试数据中可以看到分为三类：

   - **非法字符**（如 `a`）

   - **左右括号数目不匹配**（如 `(3 + 5 * (2 - 8) / 2 + 4 * (3 - 1) / 2`）

   - **计算两个数时中间出现除括号外的多个运算符**（如 `3 + 5 * (2 - 8) / 2 + 4 * (3 - 1) / 2 +`）


​	针对这三种情况，在测试数据中均有所涉及，而从测试结果中可以看出这些情况均算作错误，并输出错误信息 `ERROR IN INFIX NOTATION`。对测试数据输出结果进行分析后可得出结论：该算法以及数据结构对于基础的表达式求值均可计算出正确结果，以及对非法字符的判断也可以达到良好的错误提示输出。然而，针对时间复杂度和代码的测试结果则表明该算法循环判断较多，这方面有待进一步的改进。



## 4 总结

### 4.1 实现思路

本次实验通过设计和实现一个能够计算中缀表达式的计算器，达到了预期的目标。具体来说，实验涵盖了以下几个方面：

1. **栈的实现**：
   - 使用模板类 `stack` 实现了一个泛型栈，支持基本的栈操作（压栈、弹栈、获取栈顶元素等）。栈的实现为后续的中缀表达式转后缀表达式和计算后缀表达式提供了基础数据结构支持。

2. **中缀表达式转后缀表达式**：
   - 通过定义函数 `change`，将输入的中缀表达式转换为后缀表达式。该过程使用了两个栈：一个用于存储操作符（`t`），另一个用于存储后缀表达式（`s2`）。遍历中缀表达式的每个字符，根据字符类型（数字、操作符、括号）进行相应的处理，确保了表达式的正确转换。

3. **计算后缀表达式**：
   - 定义函数 `count`，计算后缀表达式的值。使用一个栈 `num` 存储操作数，遍历后缀表达式的每个字符，根据字符类型（数字、操作符）进行相应的计算。该过程确保了后缀表达式的正确计算。

4. **主函数**：
   - 主函数处理输入的字符串，调用 `change` 和 `count` 函数进行计算，并输出结果或错误信息。主函数的设计使得整个程序能够处理多种输入情况，并输出正确的计算结果或错误提示。



### 4.2 总结

1. 本次实验通过设计和实现一个中缀表达式计算器，掌握了栈的基本操作，理解了中缀表达式转换为后缀表达式的算法，并实现了一个能够计算中缀表达式的计算器。实验结果表明，代码能够正确处理各种合法输入，并输出正确的计算结果。同时，代码也能够处理非法输入，并输出相应的错误信息。

2. 未来学习了更多的数据结构，可以进一步优化算法和扩展功能.

​	

## 5 实验成果

- 所有代码将上传到 Github 仓库中:https://github.com/KaiHaverz/DataSturcture_Learning_Record
